<?xml version="1.0" encoding="UTF-8"?>
<workflow name="code" thinking="Normal">
  <metadata>
    <description>Code Mode - Execute implementation with focus on building, minimal discussion</description>
  </metadata>

  <important>Planning is complete. Focus 100% on implementation. Minimal discussion, maximum execution.</important>

  <when_to_use>
    <trigger>After /architect workflow is complete and approved</trigger>
    <trigger>User says "let's code" or "start implementing"</trigger>
    <trigger>Ready to execute on an existing plan</trigger>
  </when_to_use>

  <prerequisites>
    <prerequisite>prd.md exists (or clear requirements understood)</prerequisite>
    <prerequisite>checklist.md exists (or clear task list)</prerequisite>
    <prerequisite>Architecture decisions are made</prerequisite>
  </prerequisites>

  <steps>
    <step number="1" name="Load Context">
      <action>Read checklist.md to understand current progress</action>
      <action>Read prd.md for requirements</action>
      <action>Check project_rules.md for conventions</action>
      <action>Query memory/codegraph for existing patterns</action>
    </step>

    <step number="2" name="Execute Tasks">
      <instruction>For each task in the checklist:</instruction>
      <action>Read before write — Always verify file contents before modifying</action>
      <action>Implement — Write the code</action>
      <action>Test — Verify it works</action>
      <action>Update checklist — Mark task as [x] complete</action>
    </step>

    <step number="3" name="Code Quality Checks">
      <check>Edge cases handled?</check>
      <check>Error handling complete?</check>
      <check>No hardcoded secrets or paths?</check>
      <check>Types properly defined?</check>
      <check>Functions do ONE thing?</check>
    </step>

    <step number="4" name="Minimize Discussion">
      <rule>Don't over-explain obvious changes</rule>
      <rule>Focus on non-obvious logic and decisions</rule>
      <rule>Keep responses concise</rule>
      <rule>Only pause for genuine blockers</rule>
    </step>

    <step number="5" name="Update Progress">
      <action>Mark completed tasks in checklist.md</action>
      <action>Update memory/codegraph with new functions</action>
      <action>Note any deferred items</action>
    </step>
  </steps>

  <behavior_rules>
    <rule>Execute step-by-step from the checklist</rule>
    <rule>Write code efficiently with minimal preamble</rule>
    <rule>Test each change before moving on</rule>
    <rule>Only pause for genuine blockers</rule>
    <rule>Stay in implementation mode until checklist complete</rule>
  </behavior_rules>

  <exit_criteria>
    <criterion>All checklist items marked [x]</criterion>
    <criterion>All tests passing</criterion>
    <criterion>Code quality checks complete</criterion>
    <criterion>Ready for user review</criterion>
  </exit_criteria>
</workflow>

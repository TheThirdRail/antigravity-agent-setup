<?xml version="1.0" encoding="UTF-8"?>
<workflow name="research" thinking="MAX">
  <metadata>
    <description>Research Mode - Deep research with maximum thinking using all search tools</description>
  </metadata>

  <important>Use MAXIMUM thinking/reasoning depth. Prioritize the most up-to-date sources.</important>

  <when_to_use>
    <trigger>Researching best practices for a tech stack</trigger>
    <trigger>Finding current solutions to technical problems</trigger>
    <trigger>Comparing frameworks, libraries, or approaches</trigger>
    <trigger>Gathering information before /architect mode</trigger>
  </when_to_use>

  <output>
    <location>research/</location>
    <format>[topic]-research.md</format>
    <example>research/react-state-management-research.md</example>
    <note>The research/ folder should be in .gitignore</note>
  </output>

  <steps>
    <step number="1" name="Clarify the Research Topic">
      <parse>What specific topic to research?</parse>
      <parse>What decisions need to be made?</parse>
      <parse>Any constraints (free only, specific language, etc.)?</parse>
    </step>

    <step number="2" name="Use ALL Search Tools">
      <tools category="Web Search">
        <tool name="searxng">Meta-search across multiple engines</tool>
        <tool name="brave-search">Web search with privacy</tool>
        <tool name="tavily">AI-optimized search</tool>
        <tool name="arxiv">Academic papers (if relevant)</tool>
        <tool name="pubmed">Medical/science (if relevant)</tool>
        <tool name="github">Code examples, popular repos</tool>
        <tool name="fetch">Read specific URLs for deep content</tool>
      </tools>
    </step>

    <step number="2b" name="Use Context MCPs for Code Research">
      <instruction>When researching code patterns, libraries, or implementations:</instruction>
      <tools category="Code Context">
        <tool name="context7">Get up-to-date library documentation</tool>
        <tool name="gitmcp">Convert GitHub repos to markdown for analysis</tool>
        <tool name="augments">Access 90+ framework documentation sources</tool>
        <tool name="lsmcp">TypeScript/JavaScript code intelligence</tool>
        <tool name="pylance">Python code intelligence</tool>
        <tool name="serena">AI-powered code understanding</tool>
        <tool name="codegraph">Query existing codebase relationships</tool>
      </tools>
      
      <when_to_use_context_mcps>
        <use case="Researching how a library works">context7</use>
        <use case="Analyzing a GitHub repo's structure">gitmcp</use>
        <use case="Finding framework best practices">augments</use>
        <use case="Understanding existing code patterns">language servers</use>
      </when_to_use_context_mcps>
    </step>

    <step number="3" name="Prioritize Recent Sources">
      <rule>Prefer sources from 2024-2025</rule>
      <rule>Note the date of each source</rule>
      <rule>Flag any outdated information</rule>
      <rule>Look for "latest" or "current" versions</rule>
    </step>

    <step number="4" name="Research Areas to Cover">
      <category name="Tech Stack Research">
        <area>Current best practices</area>
        <area>Popular libraries/frameworks</area>
        <area>Performance considerations</area>
        <area>Security recommendations</area>
        <area>Community support/activity</area>
        <area>Learning curve</area>
        <area>Pros and cons</area>
      </category>
      
      <category name="Problem-Solving Research">
        <area>Common solutions</area>
        <area>Edge cases</area>
        <area>Performance implications</area>
        <area>Security considerations</area>
        <area>Real-world examples</area>
      </category>
    </step>

    <step number="5" name="Document Findings">
      <output_template><![CDATA[
# [Topic] Research

**Date:** [Today's date]
**Purpose:** [Why this research was needed]

## Executive Summary
[2-3 sentence summary of key findings]

## Key Findings

### Best Practices (2024-2025)
- [Finding 1] — Source: [URL]
- [Finding 2] — Source: [URL]

### Recommended Approach
[Your synthesis and recommendation]

### Alternatives Considered
| Option | Pros | Cons |
|--------|------|------|
| [Option 1] | [Pros] | [Cons] |
| [Option 2] | [Pros] | [Cons] |

### Security Considerations
- [Security note 1]
- [Security note 2]

### Sources
1. [Title](URL) — [Date] — [Brief note]
2. [Title](URL) — [Date] — [Brief note]

## Next Steps
[Recommended actions based on research]
      ]]></output_template>
    </step>

    <step number="6" name="Synthesize and Recommend">
      <rule>Don't just list findings — synthesize them</rule>
      <rule>Provide a clear recommendation</rule>
      <rule>Explain WHY you recommend it</rule>
      <rule>Note any trade-offs</rule>
    </step>
  </steps>

  <search_strategy>
    <phase order="1">Start broad — Get an overview of the landscape</phase>
    <phase order="2">Go deep — Dive into recommended approaches</phase>
    <phase order="3">Verify — Cross-reference across multiple sources</phase>
    <phase order="4">Check recency — Ensure information is current</phase>
    <phase order="5">Find examples — Look for real-world implementations</phase>
  </search_strategy>

  <quality_checks>
    <check>Multiple sources consulted?</check>
    <check>Sources are recent (2024-2025 preferred)?</check>
    <check>Both pros and cons documented?</check>
    <check>Clear recommendation provided?</check>
    <check>File saved to research/ folder?</check>
  </quality_checks>

  <exit_criteria>
    <criterion>Research file created in research/ folder</criterion>
    <criterion>Clear synthesis and recommendation provided</criterion>
    <criterion>Sources documented with dates</criterion>
    <criterion>User understands the findings</criterion>
  </exit_criteria>
</workflow>
